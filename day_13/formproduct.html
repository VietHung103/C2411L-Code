<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Management</title>
    <link rel="stylesheet" href="./form.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
</head>
<body>
    <div class="product">
        <form class="product-form">
            <label for="product_name">Product Name:</label>
            <input type="text" id="product_name" required>
            <span class="error" id="name_error"></span><br>
            
            <label for="product_price">Price:</label>
            <input type="number" id="product_price" required>
            <span class="error" id="price_error"></span><br>
            
            <label for="product_quan">Quantity:</label>
            <input type="number" id="product_quan" required>
            <span class="error" id="quan_error"></span><br>
            
            <div class="product-navigator">
                <button type="button" class="btn" id="btn-add">Add Product</button>
                <button type="button" class="btn" id="btn-show">Show Products</button>
            </div>
        </form>
        <p id="successMessage" style="color:green;"></p>
        
        <table id="product-table" border="1">
            <thead>
                <tr>
                    <th>Product Name</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="product-list">
            </tbody>
        </table>
        
        <script>
            $(document).ready(function() {
                let products = JSON.parse(localStorage.getItem("products")) || [];

                function updateTable() {
                    $("#product-list").empty();
                    products.forEach((product, index) => {
                        $("#product-list").append(`
                            <tr>
                                <td>${product.name}</td>
                                <td>${product.price}</td>
                                <td>${product.quan}</td>
                                <td>
                                    <button class="btn-edit" data-index="${index}">Edit</button>
                                    <button class="btn-delete" data-index="${index}">Delete</button>
                                </td>
                            </tr>
                        `);
                    });
                }

                $("#btn-add").click(function(event) {
                    event.preventDefault();
                    let name = $("#product_name").val().trim();
                    let price = parseFloat($("#product_price").val());
                    let quan = parseInt($("#product_quan").val());

                    if (!name || price <= 0 || quan <= 0) {
                        alert("Invalid input. Please enter valid product details.");
                        return;
                    }

                    products.push({ name, price, quan });
                    localStorage.setItem("products", JSON.stringify(products));
                    $("#successMessage").text("Product added successfully").fadeOut(3000);
                    $(".product-form")[0].reset(); // Clear form
                    updateTable();
                });

                $("#btn-show").click(function(event) {
                    event.preventDefault();
                    updateTable();
                });

                $(document).on("click", ".btn-edit", function() {
                    let index = $(this).data("index");
                    let product = products[index];
                    $("#product_name").val(product.name);
                    $("#product_price").val(product.price);
                    $("#product_quan").val(product.quan);

                    $("#btn-add").hide();
                    $(".product-navigator").append(`<button type="button" class="btn" id="btn-update">Update Product</button>`);
                    
                    $("#btn-update").click(function() {
                        products[index] = {
                            name: $("#product_name").val().trim(),
                            price: parseFloat($("#product_price").val()),
                            quan: parseInt($("#product_quan").val())
                        };
                        localStorage.setItem("products", JSON.stringify(products));
                        $(".product-form")[0].reset();
                        $("#btn-update").remove();
                        $("#btn-add").show();
                        updateTable();
                    });
                });

                $(document).on("click", ".btn-delete", function() {
                    let index = $(this).data("index");
                    products.splice(index, 1);
                    localStorage.setItem("products", JSON.stringify(products));
                    updateTable();
                });

                updateTable(); 
            });
        </script>
    </div>
</body>
</html>
